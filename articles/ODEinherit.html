<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>ODEinherit • ODEinherit</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ODEinherit">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ODEinherit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/ODEinherit.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/WenbinWu2001/ODEinherit/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>ODEinherit</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/WenbinWu2001/ODEinherit/blob/master/vignettes/ODEinherit.Rmd" class="external-link"><code>vignettes/ODEinherit.Rmd</code></a></small>
      <div class="d-none name"><code>ODEinherit.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<p>This tutorial presents a toy example of <strong>ODEinherit</strong>,
using the dataset from our <a href="https://www.biorxiv.org/content/10.1101/2024.11.23.624995v2" class="external-link">paper</a>
to estimate inheritance between mother and daughter cells.</p>
<p>A successful installation of <code>ODEinherit</code> is required. See
the last section of this article for a list of all system and package
dependencies used to create this tutorial.</p>
<p>For a single mother–daughter cell pair, the entire workflow typically
finishes in under 20 minutes when run on 8 cores of an Apple M1
chip.</p>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>Here we present the workflow for a single mother–daughter cell pair,
the same pair used to create Figure 2 in the paper. See
<code><a href="../reference/cell_lineage_data.html">?cell_lineage_data</a></code> for more details about the dataset.</p>
<p><strong>Step 0: Load the package and select a mother–daughter cell
pair</strong></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cell_lineage_data</span> <span class="op">&lt;-</span> <span class="fu">ODEinherit</span><span class="fu">::</span><span class="va"><a href="../reference/cell_lineage_data.html">cell_lineage_data</a></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cell_lineage_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "metadata"    "time_series"</span></span>
<span></span>
<span><span class="va">time_series</span> <span class="op">&lt;-</span> <span class="va">cell_lineage_data</span><span class="op">$</span><span class="va">time_series</span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="va">cell_lineage_data</span><span class="op">$</span><span class="va">metadata</span></span>
<span><span class="va">var_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">time_series</span><span class="op">)</span></span></code></pre></div>
<p>Following convention, we refer to the time series as
“trajectories.”<br>
The code below extracts and plots the trajectories for the selected
cells.<br>
(Note: In the paper, each trajectory is centered to mean 0; here, we
omit centering for clearer illustration.)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># extract trajectories by specifying cell id</span></span>
<span><span class="va">idx_M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">metadata</span><span class="op">$</span><span class="va">cell_id</span> <span class="op">==</span> <span class="st">"3-20-1"</span><span class="op">)</span></span>
<span><span class="va">idx_D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">metadata</span><span class="op">$</span><span class="va">cell_id</span> <span class="op">==</span> <span class="st">"3-20-17"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># birth time point indices (row indices of matrices in `time_series`)</span></span>
<span><span class="va">btp_idx_M</span> <span class="op">&lt;-</span> <span class="va">metadata</span><span class="op">$</span><span class="va">cell_birth_timepoint</span><span class="op">[</span><span class="va">idx_M</span><span class="op">]</span></span>
<span><span class="va">btp_idx_D</span> <span class="op">&lt;-</span> <span class="va">metadata</span><span class="op">$</span><span class="va">cell_birth_timepoint</span><span class="op">[</span><span class="va">idx_D</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># reshape data to the dimension: (# total time points, # variables)</span></span>
<span><span class="va">Y_M_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">time_series</span>, <span class="kw">function</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">{</span><span class="va">mat</span><span class="op">[</span><span class="va">idx_M</span>,<span class="op">]</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">Y_D_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">time_series</span>, <span class="kw">function</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">{</span><span class="va">mat</span><span class="op">[</span><span class="va">idx_D</span>,<span class="op">]</span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Y_M_full</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 240   6</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot the trajectories of the first variable</span></span>
<span><span class="va">var_idx</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">yj_M</span> <span class="op">&lt;-</span> <span class="va">Y_M_full</span><span class="op">[</span>,<span class="va">var_idx</span><span class="op">]</span></span>
<span><span class="va">yj_D</span> <span class="op">&lt;-</span> <span class="va">Y_D_full</span><span class="op">[</span>,<span class="va">var_idx</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">time_grid</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">time_series</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NA</span>, type <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Trajectory plot of variable "</span>, <span class="va">var_idx</span>, <span class="st">" ("</span>, <span class="va">var_names</span><span class="op">[</span><span class="va">var_idx</span><span class="op">]</span>, <span class="st">")"</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time index"</span>, ylab <span class="op">=</span> <span class="st">"Value"</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">time_grid</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, </span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">yj_M</span>, <span class="va">yj_D</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time_grid</span>, <span class="va">yj_M</span>, </span>
<span>      lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time_grid</span>, <span class="va">yj_D</span>, </span>
<span>      lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, </span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mother"</span>, <span class="st">"Daughter"</span><span class="op">)</span>,</span>
<span>       lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkred"</span>, <span class="st">"darkgreen"</span><span class="op">)</span>,</span>
<span>       cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="ODEinherit_files/figure-html/unnamed-chunk-4-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><strong>Step 1: Network estimation with KernelODE</strong></p>
<p>We begin with two numeric matrices, <code>Y_M</code> and
<code>Y_D</code>, representing the mother and daughter cells.<br>
Rows correspond to time points, and columns correspond to protein
variables.<br>
The ODE regulatory network for each cell is estimated
<em>separately</em> using KernelODE.</p>
<p>Before applying KernelODE, we:</p>
<ul>
<li>Remove the portion of each trajectory before cell birth.</li>
<li>Standardize the observation time points to the interval
<code>[0, 1]</code> for each cell.</li>
<li>Remove the linear trend in the time series to adjust for time
effects.</li>
</ul>
<p>In <strong>Step 1</strong> of KernelODE, we fit cubic smoothing
splines to obtain smoothed trajectory estimates.<br>
In <strong>Step 2</strong>, we estimate ODE regulatory networks within
an RKHS modeling framework.<br>
For this example, we use a first-order Mat'ern kernel.</p>
<p>See the original <a href="https://arxiv.org/abs/2008.02915" class="external-link">KernelODE
paper</a> for more details on the algorithm.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># remove the pre-birth portion</span></span>
<span><span class="va">Y_M</span> <span class="op">&lt;-</span> <span class="va">Y_M_full</span><span class="op">[</span><span class="va">btp_idx_M</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Y_M_full</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">Y_D</span> <span class="op">&lt;-</span> <span class="va">Y_D_full</span><span class="op">[</span><span class="va">btp_idx_D</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Y_D_full</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="co"># Note: Y_M and Y_D now start at each cell’s birth (corresponding to their first row).</span></span>
<span></span>
<span><span class="co"># standardize observation time to [0, 1] for each cell</span></span>
<span><span class="va">n_M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Y_M</span><span class="op">)</span></span>
<span><span class="va">obs_time_M</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">n_M</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_M</span><span class="op">)</span></span>
<span><span class="va">n_D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Y_D</span><span class="op">)</span></span>
<span><span class="va">obs_time_D</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">n_D</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_D</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># remove linear trend for each variable</span></span>
<span><span class="va">linear_trend_M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Y_M</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Y_M</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">linear_trend_D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Y_D</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Y_D</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Y_M</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">yj</span> <span class="op">&lt;-</span> <span class="va">Y_M</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span></span>
<span>  <span class="va">lt_fitted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">yj</span> <span class="op">~</span> <span class="va">obs_time_M</span><span class="op">)</span><span class="op">$</span><span class="va">fitted.values</span>  <span class="co"># fitted linear trend</span></span>
<span>  <span class="va">yj</span> <span class="op">&lt;-</span> <span class="va">yj</span> <span class="op">-</span> <span class="va">lt_fitted</span>  <span class="co"># remove linear trend</span></span>
<span>  </span>
<span>  <span class="va">Y_M</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">yj</span></span>
<span>  <span class="va">linear_trend_M</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">lt_fitted</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Y_D</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">yj</span> <span class="op">&lt;-</span> <span class="va">Y_D</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span></span>
<span>  <span class="va">lt_fitted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">yj</span> <span class="op">~</span> <span class="va">obs_time_D</span><span class="op">)</span><span class="op">$</span><span class="va">fitted.values</span>  <span class="co"># fitted linear trend</span></span>
<span>  <span class="va">yj</span> <span class="op">&lt;-</span> <span class="va">yj</span> <span class="op">-</span> <span class="va">lt_fitted</span>  <span class="co"># remove linear trend</span></span>
<span>  </span>
<span>  <span class="va">Y_D</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">yj</span></span>
<span>  <span class="va">linear_trend_D</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">lt_fitted</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Here we easily define a pipeline for network estimation:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kernelODE_pipeline</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Y</span>, </span>
<span>                               <span class="va">obs_time</span>, </span>
<span>                               <span class="va">kernel</span>, </span>
<span>                               <span class="va">kernel_params</span>,</span>
<span>                               <span class="va">prune_thres</span> <span class="op">=</span> <span class="fl">0.05</span>,  <span class="co"># network pruning threshold</span></span>
<span>                               <span class="va">depth</span> <span class="op">=</span> <span class="cn">NULL</span>  <span class="co"># maximum number of regulator edges to prune for each variable</span></span>
<span>                               <span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">tt</span> <span class="op">&lt;-</span> <span class="fl">0.001</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span>  <span class="co"># time grid for numerical integration, does not include 0</span></span>
<span>  </span>
<span>  <span class="co"># KernelODE step 1: smooth the observed trajectories</span></span>
<span>  <span class="va">res_step1</span> <span class="op">&lt;-</span> <span class="fu">ODEinherit</span><span class="fu">::</span><span class="fu"><a href="../reference/kernelODE_step1.html">kernelODE_step1</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">Y</span>,</span>
<span>                                           obs_time <span class="op">=</span> <span class="va">obs_time</span>,</span>
<span>                                           tt <span class="op">=</span> <span class="va">tt</span><span class="op">)</span></span>
<span>  <span class="va">yy_smth</span> <span class="op">&lt;-</span> <span class="va">res_step1</span><span class="op">$</span><span class="va">yy_smth</span></span>
<span>  </span>
<span>  <span class="co"># KernelODE step 2: estimate the derivative functions Fj's</span></span>
<span>  <span class="va">res_step2</span> <span class="op">&lt;-</span> <span class="fu">ODEinherit</span><span class="fu">::</span><span class="fu"><a href="../reference/kernelODE_step2.html">kernelODE_step2</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">Y</span>,</span>
<span>                                           obs_time <span class="op">=</span> <span class="va">obs_time</span>,</span>
<span>                                           yy_smth <span class="op">=</span> <span class="va">yy_smth</span>,</span>
<span>                                           tt <span class="op">=</span> <span class="va">tt</span>,</span>
<span>                                           kernel <span class="op">=</span> <span class="va">kernel</span>,</span>
<span>                                           kernel_params <span class="op">=</span> <span class="va">kernel_params</span>,</span>
<span>                                           interaction_term <span class="op">=</span> <span class="cn">FALSE</span>,  <span class="co"># without interaction</span></span>
<span>                                           verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">network_est_original</span> <span class="op">&lt;-</span> <span class="va">res_step2</span><span class="op">$</span><span class="va">network_est</span></span>
<span>  </span>
<span>  <span class="co"># prune the network</span></span>
<span>  <span class="va">res_prune</span> <span class="op">&lt;-</span> <span class="fu">ODEinherit</span><span class="fu">::</span><span class="fu"><a href="../reference/prune_network.html">prune_network</a></span><span class="op">(</span>network_original <span class="op">=</span> <span class="va">network_est_original</span>,  <span class="co"># network to prune</span></span>
<span>                                         prune_thres <span class="op">=</span> <span class="va">prune_thres</span>,</span>
<span>                                         depth <span class="op">=</span> <span class="va">depth</span>,</span>
<span>                                         Y_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>,  <span class="co"># here we prune it cellwise</span></span>
<span>                                         yy_smth_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">yy_smth</span><span class="op">)</span>,  </span>
<span>                                         obs_time_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">obs_time</span><span class="op">)</span>,</span>
<span>                                         tt <span class="op">=</span> <span class="va">tt</span>,</span>
<span>                                         kernel <span class="op">=</span> <span class="va">kernel</span>,</span>
<span>                                         kernel_params_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">kernel_params</span><span class="op">)</span>,</span>
<span>                                         interaction_term <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                         parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                         verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">network_est_pruned</span> <span class="op">&lt;-</span> <span class="va">res_prune</span><span class="op">$</span><span class="va">network_pruned</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>network_est_pruned <span class="op">=</span> <span class="va">network_est_pruned</span>,</span>
<span>               yy_smth <span class="op">=</span> <span class="va">yy_smth</span>,</span>
<span>               tt <span class="op">=</span> <span class="va">tt</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We now apply the pipeline separately to the mother and daughter cells
to obtain their respective regulatory networks. The pruning step is the
most time-consuming part in the pipeline. As a faster alternative, you
can specify <code>nzero</code> argument in
<code><a href="../reference/kernelODE_step2.html">ODEinherit::kernelODE_step2()</a></code> to directly control the
number of regulators selected by the Lasso.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># kernel configuration</span></span>
<span><span class="va">kernel</span> <span class="op">&lt;-</span> <span class="st">"matern"</span></span>
<span><span class="va">kernel_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lengthscale<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>  <span class="co"># recycled for all variables, used for both mother and daughter cells</span></span>
<span></span>
<span><span class="co"># run the pipeline separately for mother and daughter</span></span>
<span><span class="va">res_KernelODE_M</span> <span class="op">&lt;-</span> <span class="fu">kernelODE_pipeline</span><span class="op">(</span>Y <span class="op">=</span> <span class="va">Y_M</span>,</span>
<span>                                      obs_time <span class="op">=</span> <span class="va">obs_time_M</span>,</span>
<span>                                      kernel <span class="op">=</span> <span class="va">kernel</span>,</span>
<span>                                      kernel_params <span class="op">=</span> <span class="va">kernel_params</span><span class="op">)</span></span>
<span><span class="co">#&gt; Note: R2 increases when removing these edges:  1-&gt;1</span></span>
<span><span class="va">res_KernelODE_D</span> <span class="op">&lt;-</span> <span class="fu">kernelODE_pipeline</span><span class="op">(</span>Y <span class="op">=</span> <span class="va">Y_D</span>,</span>
<span>                                      obs_time <span class="op">=</span> <span class="va">obs_time_D</span>,</span>
<span>                                      kernel <span class="op">=</span> <span class="va">kernel</span>,</span>
<span>                                      kernel_params <span class="op">=</span> <span class="va">kernel_params</span><span class="op">)</span></span>
<span><span class="co">#&gt; Note: R2 increases when removing these edges:  4-&gt;2, 6-&gt;2, 1-&gt;4, 2-&gt;4, 3-&gt;4, 2-&gt;5, 3-&gt;5, 5-&gt;5, 2-&gt;6, 3-&gt;6, 5-&gt;6 </span></span>
<span><span class="co">#&gt; Note: R2 increases when removing these edges:  2-&gt;2</span></span>
<span></span>
<span><span class="co"># extract results</span></span>
<span><span class="va">network_est_M</span> <span class="op">&lt;-</span> <span class="va">res_KernelODE_M</span><span class="op">$</span><span class="va">network_est_pruned</span></span>
<span><span class="va">network_est_D</span> <span class="op">&lt;-</span> <span class="va">res_KernelODE_D</span><span class="op">$</span><span class="va">network_est_pruned</span></span>
<span><span class="va">yy_smth_M</span> <span class="op">&lt;-</span> <span class="va">res_KernelODE_M</span><span class="op">$</span><span class="va">yy_smth</span></span>
<span><span class="va">yy_smth_D</span> <span class="op">&lt;-</span> <span class="va">res_KernelODE_D</span><span class="op">$</span><span class="va">yy_smth</span></span>
<span><span class="va">tt_M</span> <span class="op">&lt;-</span> <span class="va">res_KernelODE_M</span><span class="op">$</span><span class="va">tt</span></span>
<span><span class="va">tt_D</span> <span class="op">&lt;-</span> <span class="va">res_KernelODE_D</span><span class="op">$</span><span class="va">tt</span></span></code></pre></div>
<p><strong>Step 2: Evaluate networks via daughter trajectory
recovery</strong></p>
<p>We refit KernelODE to recover the daughter trajectories using the
mother-derived and daughter-derived networks, respectively, to evaluate
how well each explains variation in the daughter trajectories.
Goodness-of-fit is quantified using a heuristic
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
metric.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">KODE_refit_MtoD</span> <span class="op">&lt;-</span> <span class="fu">ODEinherit</span><span class="fu">::</span><span class="fu"><a href="../reference/refit_kernel_ODE.html">refit_kernel_ODE</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">Y_D</span>,  <span class="co"># target: daughter's observed trajectories</span></span>
<span>                                                obs_time <span class="op">=</span> <span class="va">obs_time_D</span>,</span>
<span>                                                yy_smth <span class="op">=</span> <span class="va">yy_smth_D</span>,</span>
<span>                                                tt <span class="op">=</span> <span class="va">tt_D</span>,</span>
<span>                                                kernel <span class="op">=</span> <span class="va">kernel</span>, <span class="co"># same config as used for network estimation</span></span>
<span>                                                kernel_params <span class="op">=</span> <span class="va">kernel_params</span>,  <span class="co"># same config as used for network estimation</span></span>
<span>                                                interaction_term <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                                adj_matrix <span class="op">=</span> <span class="va">network_est_M</span><span class="op">)</span>  <span class="co"># use mother network</span></span>
<span><span class="va">KODE_refit_DtoD</span> <span class="op">&lt;-</span> <span class="fu">ODEinherit</span><span class="fu">::</span><span class="fu"><a href="../reference/refit_kernel_ODE.html">refit_kernel_ODE</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">Y_D</span>,  <span class="co"># target: daughter's observed trajectories</span></span>
<span>                                                obs_time <span class="op">=</span> <span class="va">obs_time_D</span>,</span>
<span>                                                yy_smth <span class="op">=</span> <span class="va">yy_smth_D</span>,</span>
<span>                                                tt <span class="op">=</span> <span class="va">tt_D</span>,</span>
<span>                                                kernel <span class="op">=</span> <span class="va">kernel</span>, </span>
<span>                                                kernel_params <span class="op">=</span> <span class="va">kernel_params</span>,  </span>
<span>                                                interaction_term <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                                adj_matrix <span class="op">=</span> <span class="va">network_est_D</span><span class="op">)</span>  <span class="co"># use daughter network</span></span></code></pre></div>
<p>We now plot the reconstructed daughter trajectories using each
network.</p>
<p><strong>Caveat:</strong> The refitted trajectories returned by
<code><a href="../reference/refit_kernel_ODE.html">refit_kernel_ODE()</a></code> exclude the portion prior to cell birth,
as this portion was removed before being passed to the pipeline.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># extract refitted daughter trajectories (both are /daughter/ trajectories!)</span></span>
<span><span class="va">Y_refit_MtoD</span> <span class="op">&lt;-</span> <span class="va">KODE_refit_MtoD</span><span class="op">$</span><span class="va">Y_refit</span></span>
<span><span class="va">Y_refit_DtoD</span> <span class="op">&lt;-</span> <span class="va">KODE_refit_DtoD</span><span class="op">$</span><span class="va">Y_refit</span></span>
<span></span>
<span><span class="co"># add the linear trend back</span></span>
<span><span class="va">Y_refit_MtoD</span> <span class="op">&lt;-</span> <span class="va">Y_refit_MtoD</span> <span class="op">+</span> <span class="va">linear_trend_D</span></span>
<span><span class="va">Y_refit_DtoD</span> <span class="op">&lt;-</span> <span class="va">Y_refit_DtoD</span> <span class="op">+</span> <span class="va">linear_trend_D</span></span>
<span></span>
<span><span class="co"># pad NA for the pre-birth portion</span></span>
<span><span class="va">Y_refit_MtoD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">btp_idx_D</span><span class="op">-</span><span class="fl">1</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Y_refit_MtoD</span><span class="op">)</span><span class="op">)</span>, <span class="va">Y_refit_MtoD</span><span class="op">)</span></span>
<span><span class="va">Y_refit_DtoD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">btp_idx_D</span><span class="op">-</span><span class="fl">1</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Y_refit_DtoD</span><span class="op">)</span><span class="op">)</span>, <span class="va">Y_refit_DtoD</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># select a variable to plot</span></span>
<span><span class="va">var_idx</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">yj_MtoD</span> <span class="op">&lt;-</span> <span class="va">Y_refit_MtoD</span><span class="op">[</span>,<span class="va">var_idx</span><span class="op">]</span></span>
<span><span class="va">yj_DtoD</span> <span class="op">&lt;-</span> <span class="va">Y_refit_DtoD</span><span class="op">[</span>,<span class="va">var_idx</span><span class="op">]</span></span>
<span><span class="va">yj_D</span> <span class="op">&lt;-</span> <span class="va">Y_D_full</span><span class="op">[</span>,<span class="va">var_idx</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># plot Mother -&gt; Daughter recovery</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NA</span>, type <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Daughter traj. reconstructed by mother network\nVar "</span>, <span class="va">var_idx</span>, <span class="st">" ("</span>, <span class="va">var_names</span><span class="op">[</span><span class="va">var_idx</span><span class="op">]</span>, <span class="st">")"</span><span class="op">)</span>,</span>
<span>     cex.main <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time index"</span>, ylab <span class="op">=</span> <span class="st">"Value"</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">time_grid</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, </span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">yj_MtoD</span>, <span class="va">yj_D</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>     <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time_grid</span>, <span class="va">yj_D</span>, </span>
<span>      lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span>  <span class="co"># observed daughter traj</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time_grid</span>, <span class="va">yj_MtoD</span>, </span>
<span>      lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span>  <span class="co"># daughter traj recovered by mother</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, </span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"obs. D."</span>, <span class="st">"M to D"</span><span class="op">)</span>,</span>
<span>       lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkgreen"</span>, <span class="st">"darkred"</span><span class="op">)</span>,</span>
<span>       cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot Daughter -&gt; Daughter recovery</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NA</span>, type <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Daughter traj. reconstructed by its own network\nVar "</span>, <span class="va">var_idx</span>, <span class="st">" ("</span>, <span class="va">var_names</span><span class="op">[</span><span class="va">var_idx</span><span class="op">]</span>, <span class="st">")"</span><span class="op">)</span>,</span>
<span>     cex.main <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time index"</span>, ylab <span class="op">=</span> <span class="st">"Value"</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">time_grid</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, </span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">yj_DtoD</span>, <span class="va">yj_D</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>     <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time_grid</span>, <span class="va">yj_D</span>, </span>
<span>      lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span>  <span class="co"># observed daughter traj</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time_grid</span>, <span class="va">yj_DtoD</span>, </span>
<span>      lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span>  <span class="co"># daughter traj recovered by itself</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, </span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"obs. D."</span>, <span class="st">"D to D"</span><span class="op">)</span>,</span>
<span>       lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkgreen"</span>, <span class="st">"darkgreen"</span><span class="op">)</span>,</span>
<span>       cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="ODEinherit_files/figure-html/unnamed-chunk-9-1.png" width="80%" style="display: block; margin: auto;"></p>
<p><strong>Step 3: Calculate the inheritance score from the trajectory
recovery metrics</strong></p>
<p>We extract the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
metrics
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mrow><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>M</mi><mo>→</mo><mi>D</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup><annotation encoding="application/x-tex">R^{2(M \to D)}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mrow><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mo>→</mo><mi>D</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup><annotation encoding="application/x-tex">R^{2(D \to D)}</annotation></semantics></math>)
and calculate the inheritance score as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>M</mi><mo>→</mo><mi>D</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>=</mo><mfrac><msup><mi>R</mi><mrow><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>M</mi><mo>→</mo><mi>D</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup><msup><mi>R</mi><mrow><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mo>→</mo><mi>D</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup></mfrac></mrow><annotation encoding="application/x-tex">\pi^{(M \to D)} = \frac{R^{2(M \to D)}}{R^{2(D \to D)}}</annotation></semantics></math>
with the value capped at 1.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">R2_MtoD</span> <span class="op">&lt;-</span> <span class="va">KODE_refit_MtoD</span><span class="op">$</span><span class="va">metrics</span><span class="op">$</span><span class="va">R2</span></span>
<span><span class="va">R2_DtoD</span> <span class="op">&lt;-</span> <span class="va">KODE_refit_DtoD</span><span class="op">$</span><span class="va">metrics</span><span class="op">$</span><span class="va">R2</span></span>
<span><span class="va">pi_score</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">R2_MtoD</span> <span class="op">/</span> <span class="va">R2_DtoD</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pi_score</span></span>
<span><span class="co">#&gt; [1] 0.6315346</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>The following shows the suggested package versions that the developer
(GitHub username: WenbinWu2001) used when developing the ODEinherit
package.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="sc">&gt;</span> devtools<span class="sc">::</span><span class="fu">session_info</span>()</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>─ Session info ───────────────────────────────────────────────────────</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a> setting  value</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a> version  R version <span class="dv">4</span>.<span class="fl">4.2</span> (<span class="dv">2024-10-31</span>)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a> os       macOS Sequoia <span class="dv">15</span>.<span class="fl">3.2</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a> system   aarch64, darwin20</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a> ui       RStudio</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a> <span class="fu">language</span> (EN)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a> collate  en_US.UTF<span class="dv">-8</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a> ctype    en_US.UTF<span class="dv">-8</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a> tz       America<span class="sc">/</span>New_York</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a> date     <span class="dv">2025-08-13</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a> rstudio  <span class="dv">2024</span>.<span class="fl">12.1</span><span class="sc">+</span><span class="dv">563</span> Kousa <span class="fu">Dogwood</span> (desktop)</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a> pandoc   <span class="fl">3.2</span> <span class="sc">@</span> <span class="er">/</span>Applications<span class="sc">/</span>RStudio.app<span class="sc">/</span>Contents<span class="sc">/</span>Resources<span class="sc">/</span>app<span class="sc">/</span>quarto<span class="sc">/</span>bin<span class="sc">/</span>tools<span class="sc">/</span>aarch64<span class="sc">/</span> (via rmarkdown)</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a> quarto   <span class="dv">1</span>.<span class="fl">5.57</span> <span class="sc">@</span> <span class="er">/</span>Applications<span class="sc">/</span>RStudio.app<span class="sc">/</span>Contents<span class="sc">/</span>Resources<span class="sc">/</span>app<span class="sc">/</span>quarto<span class="sc">/</span>bin<span class="sc">/</span>quarto</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>─ Packages ───────────────────────────────────────────────────────────</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a> package     <span class="sc">*</span> version <span class="fu">date</span> (UTC) lib source</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a> cachem        <span class="dv">1</span>.<span class="fl">1.0</span>   <span class="dv">2024-05-16</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a> callr         <span class="dv">3</span>.<span class="fl">7.6</span>   <span class="dv">2024-03-25</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.0</span>)</span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a> cli           <span class="dv">3</span>.<span class="fl">6.4</span>   <span class="dv">2025-02-13</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a> codetools     <span class="fl">0.2</span><span class="dv">-20</span>  <span class="dv">2024-03-31</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.2</span>)</span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a> desc          <span class="dv">1</span>.<span class="fl">4.3</span>   <span class="dv">2023-12-10</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a> devtools      <span class="dv">2</span>.<span class="fl">4.5</span>   <span class="dv">2022-10-11</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.0</span>)</span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a> digest        <span class="dv">0</span>.<span class="fl">6.37</span>  <span class="dv">2024-08-19</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a> ellipsis      <span class="dv">0</span>.<span class="fl">3.2</span>   <span class="dv">2021-04-29</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.0</span>)</span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a> evaluate      <span class="dv">1</span>.<span class="fl">0.3</span>   <span class="dv">2025-01-10</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a> fastmap       <span class="dv">1</span>.<span class="fl">2.0</span>   <span class="dv">2024-05-15</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a> foreach       <span class="dv">1</span>.<span class="fl">5.2</span>   <span class="dv">2022-02-02</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.0</span>)</span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a> fs            <span class="dv">1</span>.<span class="fl">6.5</span>   <span class="dv">2024-10-30</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a> glmnet        <span class="fl">4.1</span><span class="dv">-8</span>   <span class="dv">2023-08-22</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.0</span>)</span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a> glue          <span class="dv">1</span>.<span class="fl">8.0</span>   <span class="dv">2024-09-30</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a> htmltools     <span class="dv">0</span>.<span class="dv">5</span>.<span class="fl">8.1</span> <span class="dv">2024-04-04</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.0</span>)</span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a> htmlwidgets   <span class="dv">1</span>.<span class="fl">6.4</span>   <span class="dv">2023-12-06</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.0</span>)</span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a> httpuv        <span class="dv">1</span>.<span class="fl">6.15</span>  <span class="dv">2024-03-26</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.0</span>)</span>
<span id="cb10-36"><a href="#cb10-36" tabindex="-1"></a> iterators     <span class="dv">1</span>.<span class="fl">0.14</span>  <span class="dv">2022-02-05</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.0</span>)</span>
<span id="cb10-37"><a href="#cb10-37" tabindex="-1"></a> knitr         <span class="fl">1.49</span>    <span class="dv">2024-11-08</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-38"><a href="#cb10-38" tabindex="-1"></a> later         <span class="dv">1</span>.<span class="fl">4.1</span>   <span class="dv">2024-11-27</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-39"><a href="#cb10-39" tabindex="-1"></a> lattice       <span class="fl">0.22</span><span class="dv">-6</span>  <span class="dv">2024-03-20</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.2</span>)</span>
<span id="cb10-40"><a href="#cb10-40" tabindex="-1"></a> lifecycle     <span class="dv">1</span>.<span class="fl">0.4</span>   <span class="dv">2023-11-07</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.0</span>)</span>
<span id="cb10-41"><a href="#cb10-41" tabindex="-1"></a> magrittr      <span class="dv">2</span>.<span class="fl">0.3</span>   <span class="dv">2022-03-30</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.0</span>)</span>
<span id="cb10-42"><a href="#cb10-42" tabindex="-1"></a> Matrix        <span class="fl">1.7</span><span class="dv">-2</span>   <span class="dv">2025-01-23</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-43"><a href="#cb10-43" tabindex="-1"></a> memoise       <span class="dv">2</span>.<span class="fl">0.1</span>   <span class="dv">2021-11-26</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.0</span>)</span>
<span id="cb10-44"><a href="#cb10-44" tabindex="-1"></a> mime          <span class="fl">0.12</span>    <span class="dv">2021-09-28</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.0</span>)</span>
<span id="cb10-45"><a href="#cb10-45" tabindex="-1"></a> miniUI        <span class="dv">0</span>.<span class="dv">1</span>.<span class="fl">1.1</span> <span class="dv">2018-05-18</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.0</span>)</span>
<span id="cb10-46"><a href="#cb10-46" tabindex="-1"></a> ODEinherit  <span class="sc">*</span> <span class="dv">1</span>.<span class="fl">0.0</span>   <span class="dv">2025-08-13</span> [<span class="dv">1</span>] local</span>
<span id="cb10-47"><a href="#cb10-47" tabindex="-1"></a> pillar        <span class="dv">1</span>.<span class="fl">10.1</span>  <span class="dv">2025-01-07</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-48"><a href="#cb10-48" tabindex="-1"></a> pkgbuild      <span class="dv">1</span>.<span class="fl">4.6</span>   <span class="dv">2025-01-16</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-49"><a href="#cb10-49" tabindex="-1"></a> pkgconfig     <span class="dv">2</span>.<span class="fl">0.3</span>   <span class="dv">2019-09-22</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.0</span>)</span>
<span id="cb10-50"><a href="#cb10-50" tabindex="-1"></a> pkgload       <span class="dv">1</span>.<span class="fl">4.0</span>   <span class="dv">2024-06-28</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.0</span>)</span>
<span id="cb10-51"><a href="#cb10-51" tabindex="-1"></a> processx      <span class="dv">3</span>.<span class="fl">8.5</span>   <span class="dv">2025-01-08</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-52"><a href="#cb10-52" tabindex="-1"></a> profvis       <span class="dv">0</span>.<span class="fl">4.0</span>   <span class="dv">2024-09-20</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-53"><a href="#cb10-53" tabindex="-1"></a> promises      <span class="dv">1</span>.<span class="fl">3.2</span>   <span class="dv">2024-11-28</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-54"><a href="#cb10-54" tabindex="-1"></a> ps            <span class="dv">1</span>.<span class="fl">8.1</span>   <span class="dv">2024-10-28</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-55"><a href="#cb10-55" tabindex="-1"></a> purrr         <span class="dv">1</span>.<span class="fl">0.4</span>   <span class="dv">2025-02-05</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-56"><a href="#cb10-56" tabindex="-1"></a> R6            <span class="dv">2</span>.<span class="fl">6.1</span>   <span class="dv">2025-02-15</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-57"><a href="#cb10-57" tabindex="-1"></a> Rcpp          <span class="dv">1</span>.<span class="fl">0.14</span>  <span class="dv">2025-01-12</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-58"><a href="#cb10-58" tabindex="-1"></a> remotes       <span class="dv">2</span>.<span class="fl">5.0</span>   <span class="dv">2024-03-17</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-59"><a href="#cb10-59" tabindex="-1"></a> rlang         <span class="dv">1</span>.<span class="fl">1.5</span>   <span class="dv">2025-01-17</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-60"><a href="#cb10-60" tabindex="-1"></a> rmarkdown     <span class="fl">2.29</span>    <span class="dv">2024-11-04</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-61"><a href="#cb10-61" tabindex="-1"></a> rprojroot     <span class="dv">2</span>.<span class="fl">0.4</span>   <span class="dv">2023-11-05</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-62"><a href="#cb10-62" tabindex="-1"></a> rstudioapi    <span class="dv">0</span>.<span class="fl">17.1</span>  <span class="dv">2024-10-22</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-63"><a href="#cb10-63" tabindex="-1"></a> sessioninfo   <span class="dv">1</span>.<span class="fl">2.3</span>   <span class="dv">2025-02-05</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-64"><a href="#cb10-64" tabindex="-1"></a> shape         <span class="dv">1</span>.<span class="dv">4</span>.<span class="fl">6.1</span> <span class="dv">2024-02-23</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-65"><a href="#cb10-65" tabindex="-1"></a> shiny         <span class="dv">1</span>.<span class="fl">10.0</span>  <span class="dv">2024-12-14</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-66"><a href="#cb10-66" tabindex="-1"></a> survival      <span class="fl">3.8</span><span class="dv">-3</span>   <span class="dv">2024-12-17</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-67"><a href="#cb10-67" tabindex="-1"></a> tibble        <span class="dv">3</span>.<span class="fl">2.1</span>   <span class="dv">2023-03-20</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.0</span>)</span>
<span id="cb10-68"><a href="#cb10-68" tabindex="-1"></a> urlchecker    <span class="dv">1</span>.<span class="fl">0.1</span>   <span class="dv">2021-11-30</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.0</span>)</span>
<span id="cb10-69"><a href="#cb10-69" tabindex="-1"></a> usethis       <span class="dv">3</span>.<span class="fl">1.0</span>   <span class="dv">2024-11-26</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-70"><a href="#cb10-70" tabindex="-1"></a> vctrs         <span class="dv">0</span>.<span class="fl">6.5</span>   <span class="dv">2023-12-01</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.0</span>)</span>
<span id="cb10-71"><a href="#cb10-71" tabindex="-1"></a> xfun          <span class="fl">0.50</span>    <span class="dv">2025-01-07</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span>
<span id="cb10-72"><a href="#cb10-72" tabindex="-1"></a> xtable        <span class="fl">1.8</span><span class="dv">-4</span>   <span class="dv">2019-04-21</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.0</span>)</span>
<span id="cb10-73"><a href="#cb10-73" tabindex="-1"></a> yaml          <span class="dv">2</span>.<span class="fl">3.10</span>  <span class="dv">2024-07-26</span> [<span class="dv">1</span>] <span class="fu">CRAN</span> (R <span class="dv">4</span>.<span class="fl">4.1</span>)</span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Wenbin Wu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
